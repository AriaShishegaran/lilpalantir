[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/run-llama/llama_index/blob/main/docs/examples/output_parsing/guidance_pydantic_program.ipynb)

Guidance Pydantic Program[ÔÉÅ](#guidance-pydantic-program "Permalink to this heading")
====================================================================================

Generate structured data with [**guidance**](https://github.com/microsoft/guidance) via LlamaIndex.

With guidance, you can guarantee the output structure is correct by *forcing* the LLM to output desired tokens.  
This is especialy helpful when you are using lower-capacity model (e.g. the current open source models), which otherwise would struggle to generate valid output that fits the desired output schema.

If you‚Äôre opening this Notebook on colab, you will probably need to install LlamaIndex ü¶ô.


```
!pip install llama-index
```

```
from pydantic import BaseModelfrom typing import Listfrom guidance.llms import OpenAIfrom llama\_index.program import GuidancePydanticProgram
```
Define output schema


```
class Song(BaseModel):    title: str    length\_seconds: intclass Album(BaseModel):    name: str    artist: str    songs: List[Song]
```
Define guidance pydantic program


```
program = GuidancePydanticProgram(    output\_cls=Album,    prompt\_template\_str=(        "Generate an example album, with an artist and a list of songs. Using"        " the movie {{movie\_name}} as inspiration"    ),    guidance\_llm=OpenAI("text-davinci-003"),    verbose=True,)
```
Run program to get structured output.  
Text highlighted in blue is variables specified by us, text highlighted in green is generated by the LLM.


```
output = program(movie\_name="The Shining")
```
Stop program
```
Generate an example album, with an artist and a list of songs. Using the movie The Shining as inspiration```json{  "name": "The Shining",  "artist": "Jack Torrance",  "songs": [{ "title": "All Work and No Play", "length\_seconds": "180",}, { "title": "The Overlook Hotel", "length\_seconds": "240",}, { "title": "The Shining", "length\_seconds": "210",}],}```
```
The output is a valid Pydantic object that we can then use to call functions/APIs.


```
output
```

```
Album(name='The Shining', artist='Jack Torrance', songs=[Song(title='All Work and No Play', length_seconds=180), Song(title='The Overlook Hotel', length_seconds=240), Song(title='The Shining', length_seconds=210)])
```
